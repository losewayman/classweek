<template> 
<div>
<div id="log" v-show="log">
<el-input v-model="input" type="password" placeholder="请输入密码"></el-input>
<button id="butt" @click="is()">登  录</button>
</div>
  <el-table :data="tableData" style="width: 100%" v-show="islog">
    <el-table-column
      label="姓名"
      width="180">
      <template slot-scope="scope">
        <span style="margin-left: 10px">{{ scope.row.name }}</span>
      </template>
    </el-table-column>
       <el-table-column
      label="分组"
      width="180">
      <template slot-scope="scope">
        <span style="margin-left: 10px">{{ scope.row.category }}</span>
      </template>
    </el-table-column>
    <el-table-column
      label="分组"
      width="180">
      <template slot-scope="scope">
        <el-select v-model="rooter[scope.$index]" placeholder="请选择分组">
    <el-option label="开发组员" :value="-1"></el-option>
    <el-option label="运维组员" :value="-2"></el-option>
    <el-option label="产品组员" :value="-3"></el-option>
    <el-option label="开发负责人" :value="1"></el-option>
    <el-option label="运维负责人" :value="2"></el-option>
    <el-option label="产品负责人" :value="3"></el-option>
  </el-select>
      </template>
    </el-table-column>
    <el-table-column label="操作">
      <template slot-scope="scope">
        <el-button
          size="mini"
          @click.native="handleEdit(rooter[scope.$index], scope.row.id)">提交</el-button>
        <el-button
          size="mini"
          type="danger"
          @click.native="handleDelete(scope.$index,scope.row.id)">删除</el-button>
        
      </template>
    </el-table-column>
  </el-table>
  </div>
</template>
<script>
  export default {
    data() {
      return {
        rooter:[],
        tableData:[],
        password:'zypcgzs',
        input:'',
        log:true,
        islog:false
      }
    },
    methods: {
      is(){
        if(this.input===this.password){
          this.log=false;
          this.islog=true;
        }
        else{
          this.$notify({
                message:"密码错误",
                offset: 50,
                type:'error',
                duration:1500,
              });
        }
      },
      handleDelete(index,id) {
        let _this=this;
        _this.$http({
            url:'./user/updateUserStatus.action',
            method:'post',
            params:{
              "id":id,
            }
          })
          .then(function(res){
            if(res.data.status=='200'){
              _this.$notify({
                message:"删除成功",
                offset: 50,
                type:'success',
                duration:1500,
              });
              _this.tableData.splice(index,1);
            }
          })
          .catch(function(error){
              _this.$notify({
                message:"删除失败",
                offset: 50,
                type:'error',
                duration:1500,
              });
          })
      },
      handleEdit(power, id) {
        let _this=this;
        _this.$http({
            url:'./user/updatePower.action',
            method:'post',
            params:{
              'id':id,
              'power':power,
            }
          })
          .then(function(res){
            if(res.data.status=='200'){
               _this.$notify({
                message:"提交成功",
                offset: 50,
                type:'success',
                duration:1500,
              });
            }
          })
          .catch(function(error){
              _this.$notify({
                message:"提交失败",
                offset: 50,
                type:'error',
                duration:1500,
              });
          })
      }
    },
   mounted() {
      let _this=this;
        _this.$http({
            url:'./getUserList.action',
            method:'post',
            params:{
            }
          })
          .then(function(res){
            if(res.data.status=='200'){
              _this.tableData=res.data.data;
              for(let a=0;a<_this.tableData.length;a++){
                _this.rooter.push(_this.tableData[a].power);
              }
            }
          })
          .catch(function(error){
              _this.$notify({
                message:"信息加载失败",
                offset: 50,
                type:'error',
                duration:1500,
              });
          })
      }
  }
</script>
<style>
#log{
  width:250px;
  height:110px;
  margin:100px auto;
  padding:20px;
  background-color:	#E0FFFF;
  border:1px solid #7bbfea;
}
#butt{
  width:100%;
  height:35px;
  margin-top:30px;
  background-color:#33a3dc;
  border-width:0px;
  border-radius:3px;
}
</style>